<div class="goal-editor">
  <div class="editor-header">
    <h2 class="editor-title">{{ (isEditMode ? 'FINANCE.GOALS.EDITOR.TITLE_EDIT' : 'FINANCE.GOALS.EDITOR.TITLE_CREATE') |
      translate }}</h2>

  </div>

  <form [formGroup]="goalForm" (ngSubmit)="onSubmit()" class="goal-form">
    
    <div class="form-group">
      <label for="title" class="form-label required">{{ 'FINANCE.GOALS.EDITOR.TITLE_LABEL' | translate }}</label>
      <input id="title" type="text" formControlName="title" class="form-input"
        [placeholder]="'FINANCE.GOALS.EDITOR.TITLE_PLACEHOLDER' | translate"
        [class.error]="goalForm.get('title')?.invalid && goalForm.get('title')?.touched" />
      <div class="error-message" *ngIf="getError('title')">
        {{ getError('title') }}
      </div>
    </div>

    <div class="form-group">
      <label for="description" class="form-label">{{ 'FINANCE.GOALS.EDITOR.DESCRIPTION_LABEL' | translate }}</label>
      <textarea id="description" formControlName="description" class="form-textarea"
        [placeholder]="'FINANCE.GOALS.EDITOR.DESCRIPTION_PLACEHOLDER' | translate" rows="3"></textarea>
    </div>

    <div class="form-row">
      
      <div class="form-group flex-2">
        <label for="targetAmount" class="form-label required">{{ 'FINANCE.GOALS.EDITOR.TARGET_AMOUNT_LABEL' | translate
          }}</label>
        <input id="targetAmount" type="number" formControlName="targetAmount" placeholder="0.00" step="0.01"
          class="form-input"
          [class.error]="goalForm.get('targetAmount')?.invalid && goalForm.get('targetAmount')?.touched" />
        <div class="error-message" *ngIf="getError('targetAmount')">
          {{ getError('targetAmount') }}
        </div>
      </div>

      <div class="form-group flex-1">
        <label for="currencyCode" class="form-label required">{{ 'FINANCE.GOALS.EDITOR.CURRENCY_LABEL' | translate
          }}</label>
        <select id="currencyCode" formControlName="currencyCode" class="form-select"
          [class.error]="goalForm.get('currencyCode')?.invalid && goalForm.get('currencyCode')?.touched">
          <option value="" disabled>{{ 'FINANCE.GOALS.EDITOR.CURRENCY_SELECT' | translate }}</option>
          <option *ngFor="let currency of currencies" [value]="currency.code">
            {{ currency.symbol }} {{ currency.code }} - {{ currency.name }}
          </option>
        </select>
      </div>
    </div>

    <div class="form-group" *ngIf="!isEditMode">
      <label for="currentAmount" class="form-label">{{ 'FINANCE.GOALS.EDITOR.CURRENT_AMOUNT_LABEL' | translate
        }}</label>
      <input id="currentAmount" type="number" formControlName="currentAmount" placeholder="0.00" step="0.01"
        class="form-input" />
      <small class="form-hint">{{ 'FINANCE.GOALS.EDITOR.CURRENT_AMOUNT_HINT' | translate }}</small>
    </div>

    <div class="info-message" *ngIf="isEditMode">
      <div class="info-icon">ℹ️</div>
      <div>
        <strong>{{ 'FINANCE.GOALS.EDITOR.CURRENT_AMOUNT_INFO' | translate:{amount: goalForm.get('currentAmount')?.value}
          }}</strong>
        <p>{{ 'FINANCE.GOALS.EDITOR.CURRENT_AMOUNT_CHANGE_HINT' | translate }}</p>
      </div>
    </div>

    <div class="form-group">
      <label for="deadline" class="form-label">{{ 'FINANCE.GOALS.EDITOR.DEADLINE_LABEL' | translate }}</label>
      <input id="deadline" type="date" formControlName="deadline" [min]="minDate" class="form-input" />
      <small class="form-hint">{{ 'FINANCE.GOALS.EDITOR.DEADLINE_HINT' | translate }}</small>
    </div>

    <div class="progress-section" *ngIf="isEditMode && goal">
      <div class="progress-header">
        <span>{{ 'FINANCE.GOALS.EDITOR.PROGRESS' | translate }}: {{ goal.progressPercentage }}%</span>
        <span>{{ goal.currentAmount | number:'1.2-2' }} / {{ goal.targetAmount | number:'1.2-2' }} {{ goal.currencyCode
          }}</span>
      </div>
      <div class="progress-bar">
        <div class="progress-fill" [style.width.%]="goal.progressPercentage"></div>
      </div>
    </div>

    <div class="form-actions">
      <button type="button" class="btn btn-secondary" (click)="onCancel()" [disabled]="saving">
        {{ 'FINANCE.GOALS.EDITOR.CANCEL' | translate }}
      </button>
      <button type="submit" class="btn btn-primary" [disabled]="goalForm.invalid || saving">
        <span *ngIf="!saving">{{ (isEditMode ? 'FINANCE.GOALS.EDITOR.UPDATE' : 'FINANCE.GOALS.EDITOR.CREATE') |
          translate }}</span>
        <span *ngIf="saving">{{ 'FINANCE.GOALS.EDITOR.SAVING' | translate }}</span>
      </button>
    </div>

  </form>
</div>