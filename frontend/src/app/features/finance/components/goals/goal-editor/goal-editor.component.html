<div class="goal-editor">
  <h2 class="editor-title">{{ isEditMode ? '–†–µ–¥–∞–≥—É–≤–∞—Ç–∏ —Ü—ñ–ª—å' : '–°—Ç–≤–æ—Ä–∏—Ç–∏ —Ü—ñ–ª—å' }}</h2>

  <form [formGroup]="goalForm" (ngSubmit)="onSubmit()" class="goal-form">

    <!-- Title -->
    <div class="form-group">
      <label for="title" class="form-label required">–ù–∞–∑–≤–∞ —Ü—ñ–ª—ñ</label>
      <input
        id="title"
        type="text"
        formControlName="title"
        class="form-input"
        placeholder="–ù–∞–ø—Ä–∏–∫–ª–∞–¥: –í—ñ–¥–ø—É—Å—Ç–∫–∞, –ù–æ–≤–∏–π –Ω–æ—É—Ç–±—É–∫, –ù–∞–≤—á–∞–Ω–Ω—è"
        [class.error]="goalForm.get('title')?.invalid && goalForm.get('title')?.touched"
      />
      <span class="error-message" *ngIf="getError('title')">{{ getError('title') }}</span>
    </div>

    <!-- Description -->
    <div class="form-group">
      <label for="description" class="form-label">–û–ø–∏—Å</label>
      <textarea
        id="description"
        formControlName="description"
        class="form-textarea"
        rows="3"
        placeholder="–î–æ–¥–∞–π—Ç–µ –¥–µ—Ç–∞–ª—ñ –ø—Ä–æ –≤–∞—à—É —Ü—ñ–ª—å..."
      ></textarea>
    </div>

    <!-- Target Amount & Currency -->
    <div class="form-row">
      <div class="form-group flex-2">
        <label for="targetAmount" class="form-label required">–¶—ñ–ª—å–æ–≤–∞ —Å—É–º–∞</label>
        <input
          id="targetAmount"
          type="number"
          formControlName="targetAmount"
          class="form-input"
          placeholder="0.00"
          step="0.01"
          min="0.01"
          [class.error]="goalForm.get('targetAmount')?.invalid && goalForm.get('targetAmount')?.touched"
        />
        <span class="error-message" *ngIf="getError('targetAmount')">{{ getError('targetAmount') }}</span>
      </div>

      <div class="form-group">
        <label for="currencyCode" class="form-label required">–í–∞–ª—é—Ç–∞</label>
        <select
          id="currencyCode"
          formControlName="currencyCode"
          class="form-select"
        >
          <option value="" disabled>{{ loadingCurrencies ? '–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...' : '–û–±–µ—Ä—ñ—Ç—å –≤–∞–ª—é—Ç—É' }}</option>
          <option *ngFor="let currency of currencies" [value]="currency.code">
            {{ currency.symbol }} {{ currency.code }} - {{ currency.name }}
          </option>
        </select>
      </div>
    </div>

    <!-- Current Amount (only for create mode) -->
    <div class="form-group" *ngIf="!isEditMode">
      <label for="currentAmount" class="form-label">–ü–æ—Ç–æ—á–Ω–∞ —Å—É–º–∞</label>
      <input
        id="currentAmount"
        type="number"
        formControlName="currentAmount"
        class="form-input"
        placeholder="0.00"
        step="0.01"
        min="0"
        [class.error]="goalForm.get('currentAmount')?.invalid && goalForm.get('currentAmount')?.touched"
      />
      <span class="form-hint">–ü–æ—á–∞—Ç–∫–æ–≤–∞ —Å—É–º–∞, —è–∫–∞ –≤–∂–µ –Ω–∞–∫–æ–ø–∏—á–µ–Ω–∞ (–∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º 0)</span>
    </div>

    <!-- Info message for edit mode -->
    <div class="info-message" *ngIf="isEditMode && goal">
      <span class="info-icon">‚ÑπÔ∏è</span>
      <div>
        <strong>–ü–æ—Ç–æ—á–Ω–∞ —Å—É–º–∞: {{ goal.currentAmount | number:'1.2-2' }} {{ goal.currencyCode }}</strong>
        <p>–î–ª—è –∑–º—ñ–Ω–∏ –ø–æ—Ç–æ—á–Ω–æ—ó —Å—É–º–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –∫–Ω–æ–ø–∫–∏ + / - —É —Å–ø–∏—Å–∫—É —Ü—ñ–ª–µ–π</p>
      </div>
    </div>

    <!-- Deadline -->
    <div class="form-group">
      <label for="deadline" class="form-label">–î–µ–¥–ª–∞–π–Ω</label>
      <input
        id="deadline"
        type="date"
        formControlName="deadline"
        class="form-input"
        [min]="minDate"
      />
      <span class="form-hint">–û–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ: –∫–æ–ª–∏ –≤–∏ –ø–ª–∞–Ω—É—î—Ç–µ –¥–æ—Å—è–≥—Ç–∏ —Ü—ñ—î—ó —Ü—ñ–ª—ñ?</span>
    </div>

    <!-- Progress indicator (edit mode only) -->
    <div class="progress-section" *ngIf="isEditMode && goal">
      <div class="progress-header">
        <span>–ü—Ä–æ–≥—Ä–µ—Å: {{ goal.progressPercentage }}%</span>
        <span>{{ goal.currentAmount | number:'1.2-2' }} / {{ goal.targetAmount | number:'1.2-2' }} {{ goal.currencyCode }}</span>
      </div>
      <div class="progress-bar">
        <div class="progress-fill" [style.width.%]="goal.progressPercentage"></div>
      </div>
    </div>

    <!-- Actions -->
    <div class="form-actions">
      <button type="button" class="btn btn-secondary" (click)="onCancel()" [disabled]="saving">
        ‚ùå –°–∫–∞—Å—É–≤–∞—Ç–∏
      </button>
      <button type="submit" class="btn btn-primary" [disabled]="goalForm.invalid || saving">
        <span *ngIf="!saving">{{ isEditMode ? 'üíæ –ó–±–µ—Ä–µ–≥—Ç–∏' : '‚ûï –°—Ç–≤–æ—Ä–∏—Ç–∏' }}</span>
        <span *ngIf="saving">‚è≥ –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è...</span>
      </button>
    </div>

  </form>
</div>
