<div class="goal-detail-container">
  <!-- Header -->
  <div class="detail-header">
    <button class="btn btn-back" (click)="goBack()">
      <span>‚Üê</span> {{ 'FINANCE.GOALS.DETAIL.BACK' | translate }}
    </button>
    <h2>üéØ {{ 'FINANCE.GOALS.DETAIL.TITLE' | translate }}</h2>
  </div>

  <!-- Loading State -->
  <div *ngIf="loading" class="loading-state">
    <div class="spinner"></div>
    <p>{{ 'FINANCE.GOALS.LOADING' | translate }}</p>
  </div>

  <!-- Error State -->
  <div *ngIf="errorMessage" class="error-state">
    <p>‚ùå {{ errorMessage }}</p>
    <button class="btn btn-primary" (click)="goBack()">{{ 'FINANCE.GOALS.DETAIL.BACK_LIST' | translate }}</button>
  </div>

  <!-- Goal Detail -->
  <div *ngIf="!loading && !errorMessage && goal" class="goal-detail">
    <!-- Main Card -->
    <div class="detail-card main-card">
      <!-- Header -->
      <div class="card-header">
        <div class="goal-title-section">
          <h1>{{ goal.title }}</h1>
          <p *ngIf="goal.description" class="goal-description">
            {{ goal.description }}
          </p>
        </div>
      </div>

      <!-- Progress Section -->
      <div class="progress-section">
        <div class="amount-summary">
          <div class="amount-item saved">
            <label>{{ 'FINANCE.GOALS.DETAIL.SAVED' | translate }}</label>
            <div class="amount-value">
              {{ formatAmount(goal.currentAmount, goal.currencyCode) }}
            </div>
          </div>
          <div class="amount-divider">/</div>
          <div class="amount-item target">
            <label>{{ 'FINANCE.GOALS.DETAIL.TARGET' | translate }}</label>
            <div class="amount-value">
              {{ formatAmount(goal.targetAmount, goal.currencyCode) }}
            </div>
          </div>
        </div>

        <div class="progress-bar-container">
          <div class="progress-bar">
            <div class="progress-fill" [style.width.%]="getProgressPercentage()"
              [style.background]="getProgressColor()">
            </div>
          </div>
          <div class="progress-label">
            {{ getProgressPercentage().toFixed(1) }}%
          </div>
        </div>

        <div class="remaining-section" *ngIf="!isCompleted()">
          <div class="remaining-icon">üí∞</div>
          <div class="remaining-text">
            <strong>{{ formatAmount(getRemainingAmount(), goal.currencyCode) }}</strong>
            <span>{{ 'FINANCE.GOALS.DETAIL.REMAINING' | translate }}</span>
          </div>
        </div>

        <div class="completed-section" *ngIf="isCompleted()">
          <div class="completed-icon">üéâ</div>
          <div class="completed-text">
            <strong>{{ 'FINANCE.GOALS.DETAIL.COMPLETED_TITLE' | translate }}</strong>
          </div>
        </div>
      </div>

      <!-- Details Section -->
      <div class="details-section">
        <!-- Deadline -->
        <div class="detail-item" *ngIf="goal.deadline">
          <label>{{ 'FINANCE.GOALS.DETAIL.DEADLINE' | translate }}</label>
          <div class="deadline-display">
            <span class="deadline-date">{{ formatDate(goal.deadline) }}</span>
            <span *ngIf="goal.isOverdue" class="deadline-status overdue">
              ‚ö†Ô∏è {{ 'FINANCE.GOALS.DETAIL.OVERDUE' | translate }}
            </span>
            <span *ngIf="!goal.isOverdue && goal.isDeadlineApproaching" class="deadline-status approaching">
              ‚è∞ {{ 'FINANCE.GOALS.DETAIL.APPROACHING' | translate }}
            </span>
          </div>
        </div>

        <!-- Completion Date -->
        <div class="detail-item" *ngIf="goal.completedAt">
          <label>{{ 'FINANCE.GOALS.DETAIL.COMPLETED' | translate }}</label>
          <div class="completed-date">
            <span class="completed-icon">‚úÖ</span>
            {{ formatDate(goal.completedAt) }}
          </div>
        </div>

        <!-- Status -->
        <div class="detail-item">
          <label>{{ 'FINANCE.GOALS.DETAIL.STATUS' | translate }}</label>
          <div class="status-badges">
            <span class="status-badge completed" *ngIf="isCompleted()">
              üéâ {{ 'FINANCE.GOALS.DETAIL.STATUS_COMPLETED' | translate }}
            </span>
          </div>
        </div>

        <!-- Created/Updated -->
        <div class="detail-item">
          <label>{{ 'FINANCE.GOALS.DETAIL.CREATED' | translate }}</label>
          <div class="timestamp">{{ formatDate(goal.createdAt) }}</div>
        </div>
        <div class="detail-item" *ngIf="goal.updatedAt">
          <label>{{ 'FINANCE.GOALS.DETAIL.UPDATED' | translate }}</label>
          <div class="timestamp">{{ formatDate(goal.updatedAt) }}</div>
        </div>
      </div>
    </div>

    <!-- Actions Card -->
    <div class="detail-card actions-card">
      <h3>{{ 'FINANCE.GOALS.DETAIL.ACTIONS' | translate }}</h3>
      <div class="action-buttons">
        <button class="btn btn-primary" (click)="editGoal()">
          <span>‚úèÔ∏è</span> {{ 'FINANCE.GOALS.DETAIL.EDIT' | translate }}
        </button>
      </div>
    </div>

    <!-- Transactions Card -->
    <div class="detail-card transactions-card">
      <div class="card-header">
        <h3>üí∞ {{ 'FINANCE.GOALS.DETAIL.TRANSACTIONS' | translate }}</h3>
        <span class="transaction-count">{{ 'FINANCE.GOALS.DETAIL.TRANSACTIONS_COUNT' | translate:{count:
          transactions.length, suffix: (transactions.length !== 1 ? 's' : '')} }}</span>
      </div>

      <!-- Loading State -->
      <div *ngIf="loadingTransactions" class="loading-state">
        <div class="spinner-small"></div>
        <p>{{ 'FINANCE.GOALS.DETAIL.TRANSACTIONS_LOADING' | translate }}</p>
      </div>

      <!-- Empty State -->
      <div *ngIf="!loadingTransactions && transactions.length === 0" class="empty-state">
        <p>üì≠ {{ 'FINANCE.GOALS.DETAIL.TRANSACTIONS_EMPTY' | translate }}</p>
      </div>

      <!-- Transactions List -->
      <div *ngIf="!loadingTransactions && transactions.length > 0" class="transactions-list">
        <div *ngFor="let transaction of transactions" class="transaction-item"
          (click)="viewTransaction(transaction.id)">
          <div class="transaction-icon" [style.color]="getTransactionTypeColor(transaction.type)">
            {{ getTransactionTypeIcon(transaction.type) }}
          </div>
          <div class="transaction-info">
            <div class="transaction-title">{{ transaction.title || transaction.description || 'Transaction' }}</div>
            <div class="transaction-meta">
              <span class="transaction-date">{{ formatDate(transaction.date) }}</span>
              <span *ngIf="transaction.category" class="transaction-category">
                ‚Ä¢ {{ transaction.category.name }}
              </span>
            </div>
          </div>
          <div class="transaction-amount" [style.color]="getTransactionTypeColor(transaction.type)">
            <span class="amount-sign">{{ transaction.type === 'Income' ? '+' : '-' }}</span>
            {{ formatAmount(transaction.amount, transaction.currencyCode) }}
          </div>
        </div>
      </div>
    </div>
  </div>
</div>