<div class="goal-list">
  <div class="list-header">
    <h1>üéØ –§—ñ–Ω–∞–Ω—Å–æ–≤—ñ —Ü—ñ–ª—ñ</h1>
    <button class="btn btn-primary" (click)="createGoal()">‚ûï –°—Ç–≤–æ—Ä–∏—Ç–∏ —Ü—ñ–ª—å</button>
  </div>

  <!-- Filters -->
  <div class="filters-section">
    <form [formGroup]="filterForm" class="filters-form">
      <div class="filter-row">
        <div class="filter-group search-group">
          <label>–ü–æ—à—É–∫</label>
          <input
            type="text"
            formControlName="search"
            placeholder="–ü–æ—à—É–∫ –ø–æ –Ω–∞–∑–≤—ñ –∞–±–æ –æ–ø–∏—Å—É..."
            class="filter-input"
          />
        </div>

        <div class="filter-group">
          <label>–°—Ç–∞—Ç—É—Å</label>
          <select formControlName="status" class="filter-select">
            <option value="active">–ê–∫—Ç–∏–≤–Ω—ñ</option>
            <option value="completed">–ó–∞–≤–µ—Ä—à–µ–Ω—ñ</option>
            <option value="all">–í—Å—ñ —Ü—ñ–ª—ñ</option>
            <option value="archived">–ê—Ä—Ö—ñ–≤–æ–≤–∞–Ω—ñ</option>
          </select>
        </div>

        <div class="filter-group">
          <label>–í–∞–ª—é—Ç–∞</label>
          <select formControlName="currencyCode" class="filter-select" [disabled]="loadingCurrencies">
            <option value="">{{ loadingCurrencies ? '–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...' : '–í—Å—ñ –≤–∞–ª—é—Ç–∏' }}</option>
            <option *ngFor="let currency of currencies" [value]="currency.code">
              {{ currency.symbol }} {{ currency.code }} - {{ currency.name }}
            </option>
          </select>
        </div>

        <button type="button" class="btn btn-secondary" (click)="clearFilters()">üîÑ –û—á–∏—Å—Ç–∏—Ç–∏</button>
      </div>
    </form>

    <!-- Results counter -->
    <div class="results-counter" *ngIf="!loading">
      <span>{{ filteredGoals.length }} –∑ {{ goals.length }} —Ü—ñ–ª–µ–π</span>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="loading" class="loading-state">
    <div class="spinner"></div>
    <p>–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ü—ñ–ª–µ–π...</p>
  </div>

  <!-- Error State -->
  <div *ngIf="errorMessage && !loading" class="error-state">
    <p>‚ùå {{ errorMessage }}</p>
  </div>

  <!-- Empty State -->
  <div *ngIf="!loading && empty" class="empty-state">
    <div class="empty-icon">üéØ</div>
    <h3>–ù–µ–º–∞—î —Ü—ñ–ª–µ–π</h3>
    <p>–°—Ç–≤–æ—Ä—ñ—Ç—å —Å–≤–æ—é –ø–µ—Ä—à—É —Ñ—ñ–Ω–∞–Ω—Å–æ–≤—É —Ü—ñ–ª—å</p>
    <button class="btn btn-primary" (click)="createGoal()">‚ûï –°—Ç–≤–æ—Ä–∏—Ç–∏ —Ü—ñ–ª—å</button>
  </div>

  <!-- No Results State -->
  <div *ngIf="!loading && !empty && filteredGoals.length === 0" class="empty-state">
    <div class="empty-icon">üîç</div>
    <h3>–ù—ñ—á–æ–≥–æ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ</h3>
    <p>–°–ø—Ä–æ–±—É–π—Ç–µ –∑–º—ñ–Ω–∏—Ç–∏ —Ñ—ñ–ª—å—Ç—Ä–∏</p>
  </div>

  <!-- Goals Grid -->
  <div *ngIf="!loading && filteredGoals.length > 0" class="goals-grid">
    <div *ngFor="let goal of filteredGoals" class="goal-card"
         [class.completed]="goal.isCompleted"
         [class.archived]="goal.isArchived">

      <!-- Card Header -->
      <div class="card-header">
        <h3 class="goal-title">{{ goal.title }}</h3>
        <div class="goal-actions">
          <button class="btn-icon" (click)="editGoal(goal.id)" title="–†–µ–¥–∞–≥—É–≤–∞—Ç–∏">‚úèÔ∏è</button>

          <button *ngIf="!goal.isArchived" class="btn-icon" (click)="archiveGoal(goal.id)" title="–ê—Ä—Ö—ñ–≤—É–≤–∞—Ç–∏">üì¶</button>
          <button *ngIf="goal.isArchived" class="btn-icon" (click)="restoreGoal(goal.id)" title="–í—ñ–¥–Ω–æ–≤–∏—Ç–∏">‚ôªÔ∏è</button>

          <button *ngIf="goal.isArchived" class="btn-icon danger" (click)="deleteGoal(goal.id)" title="–í–∏–¥–∞–ª–∏—Ç–∏ –Ω–∞–∑–∞–≤–∂–¥–∏">üóëÔ∏è</button>
        </div>
      </div>

      <!-- Description -->
      <p *ngIf="goal.description" class="goal-description">{{ goal.description }}</p>

      <!-- Status Badges -->
      <div class="status-badges">
        <span *ngIf="goal.isCompleted" class="badge completed">‚úÖ –î–æ—Å—è–≥–Ω—É—Ç–æ</span>
        <span *ngIf="goal.isArchived" class="badge archived">üì¶ –ê—Ä—Ö—ñ–≤</span>
        <span *ngIf="goal.isOverdue && !goal.isCompleted" class="badge overdue">‚è∞ –ü—Ä–æ—Å—Ç—Ä–æ—á–µ–Ω–æ</span>
        <span *ngIf="goal.isDeadlineApproaching && !goal.isCompleted && !goal.isOverdue" class="badge approaching">‚ö†Ô∏è –î–µ–¥–ª–∞–π–Ω –Ω–∞–±–ª–∏–∂–∞—î—Ç—å—Å—è</span>
      </div>

      <!-- Progress Section -->
      <div class="progress-section">
        <div class="progress-header">
          <span class="progress-percentage">{{ goal.progressPercentage }}%</span>
          <span class="progress-amounts">
            {{ goal.currentAmount | number:'1.2-2' }} / {{ goal.targetAmount | number:'1.2-2' }} {{ goal.currencyCode }}
          </span>
        </div>

        <!-- Progress Bar -->
        <div class="progress-bar">
          <div class="progress-fill"
               [style.width.%]="goal.progressPercentage"
               [class.completed]="goal.isCompleted"
               [class.high]="goal.progressPercentage >= 75 && !goal.isCompleted"
               [class.medium]="goal.progressPercentage >= 50 && goal.progressPercentage < 75"
               [class.low]="goal.progressPercentage < 50">
          </div>
        </div>

        <!-- Deadline Countdown -->
        <div class="deadline-section" *ngIf="goal.deadline">
          <div class="deadline-info" [class]="getDeadlineClass(goal)">
            <span class="deadline-icon">üìÖ</span>
            <span class="deadline-text">{{ getDeadlineCountdown(goal.deadline) }}</span>
            <span class="deadline-date">({{ goal.deadline | date:'dd/MM/yyyy' }})</span>
          </div>
        </div>

        <!-- Completion Info -->
        <div class="completion-info" *ngIf="goal.completedAt">
          <span class="completion-icon">üéâ</span>
          <span class="completion-text">–î–æ—Å—è–≥–Ω—É—Ç–æ {{ goal.completedAt | date:'dd/MM/yyyy' }}</span>
        </div>
      </div>

      <!-- Amount Controls -->
      <div class="amount-controls" *ngIf="!goal.isCompleted && !goal.isArchived">
        <button class="btn btn-small btn-success" (click)="addAmount(goal)" title="–î–æ–¥–∞—Ç–∏ —Å—É–º—É">
          ‚ûï –î–æ–¥–∞—Ç–∏
        </button>
        <button class="btn btn-small btn-warning" (click)="subtractAmount(goal)" title="–í—ñ–¥–Ω—è—Ç–∏ —Å—É–º—É">
          ‚ûñ –í—ñ–¥–Ω—è—Ç–∏
        </button>
      </div>

      <!-- Archived Timestamp -->
      <div class="archived-info" *ngIf="goal.isArchived">
        <span class="archived-text">üì¶ –ê—Ä—Ö—ñ–≤–æ–≤–∞–Ω–æ {{ goal.createdAt | date:'dd/MM/yyyy' }}</span>
      </div>
    </div>
  </div>
</div>
